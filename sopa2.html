<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Sopa de Letras con Arrastre</title>
<style>
table { border-collapse: collapse; margin: 20px auto; }
td { width: 35px; height: 35px; text-align: center; font-size: 20px; border: 1px solid black; cursor: pointer; }
.selected { background-color: lightblue; }
.found { background-color: lightgreen; }
</style>
</head>
<body>
<h1>Sopa de Letras con Selección de Arrastre</h1>
<table id="puzzle"></table>

<script>
const palabras = ["MEDULA", "CEREBRO", "CEREBELO", "TRONCO", "REFLEJO"];
const tamaño = 16;
let matriz = Array.from({ length: tamaño }, () => Array(tamaño).fill(''));
  let seleccion = []; // Guarda las celdas seleccionadas
let arrastrando = false;

function colocarPalabra(palabra) {
    let direcciones = ['horizontal', 'vertical', 'diagonal'];
    let direccion = direcciones[Math.floor(Math.random() * direcciones.length)];
    let intentos = 100; // Número de intentos para ubicar la palabra correctamente

    while (intentos > 0) {
        let fila = Math.floor(Math.random() * tamaño);
        let columna = Math.floor(Math.random() * tamaño);
        let puedeColocarse = true;

        for (let i = 0; i < palabra.length; i++) {
            let f = fila + (direccion === 'vertical' ? i : direccion === 'diagonal' ? i : 0);
            let c = columna + (direccion === 'horizontal' ? i : direccion === 'diagonal' ? i : 0);

            if (f >= tamaño || c >= tamaño || matriz[f][c] !== '') {
                puedeColocarse = false;
                break;
            }
        }

        if (puedeColocarse) {
            for (let i = 0; i < palabra.length; i++) {
                let f = fila + (direccion === 'vertical' ? i : direccion === 'diagonal' ? i : 0);
                let c = columna + (direccion === 'horizontal' ? i : direccion === 'diagonal' ? i : 0);
                matriz[f][c] = palabra[i];
            }
            return; // Sale del bucle si se colocó correctamente
        }
        intentos--;
    }
}

palabras.forEach(colocarPalabra);

  matriz = matriz.map(row => row.map(cell => cell || String.fromCharCode(65 + Math.random() * 26)));

function mostrarJuego() {
    let tabla = document.getElementById("puzzle");
    matriz.forEach((fila, i) => {
    let row = tabla.insertRow();
    fila.forEach((letra, j) => {
        let cell = row.insertCell();
        cell.textContent = letra;
        cell.dataset.pos = `${i}-${j}`;

        cell.addEventListener("mousedown", () => {
        arrastrando = true;
        seleccion = [cell];
        cell.classList.add("selected");
        });

        cell.addEventListener("mousemove", () => {
        if (arrastrando && !seleccion.includes(cell)) {
            seleccion.push(cell);
            cell.classList.add("selected");
        }
        });

        cell.addEventListener("mouseup", () => {
        arrastrando = false;
        let palabraSeleccionada = seleccion.map(c => c.textContent).join("");
        
        if (palabras.includes(palabraSeleccionada)) {
            seleccion.forEach(c => c.classList.replace("selected", "found"));
        } else {
            seleccion.forEach(c => c.classList.remove("selected"));
        }

        seleccion = [];
        });
    });
    });
}
mostrarJuego();
</script>
</body>
</html>